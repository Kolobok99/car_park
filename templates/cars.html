{% extends "base.html" %}
{% load static %}
{% block static_href  %}

    {% static 'css/cars.css' %}

{% endblock static_href %}

{% block title %}
    Авто
{% endblock title %}

{% block car_active %}
    active-page
{% endblock car_active %}


{% block main %}
<div class="main">
            <div class="main__container">

                <div class="main__title">
                    <h1>Автомобили</h1>
                    <p>{{ cars.count }}</p>
                </div>
            <form method="get" action="{% url 'cars' %}">
                <ul class="main__filtration filtr-items">
                    <li class="filtr-items__item placeholder">
                        <input name="registration_number" type="text" placeholder="номер" value="">
                    </li>
                    <li class="filtr-items__item">
                        <p class="filtr-items__title">Марка</p>
                        <ul class="filtr-items__sub-menu">
                          {% for brand in view.get_car_brands %}
                            <label for="{{ brand.id }}" class="filtr-items__check-label">
                                <li class="filtr-items__sub-item"><input class="filtr-items__check" type="checkbox" name="brand" value="{{ brand.id }}" id="{{ brand.id }}">
                                    <label for="{{ brand.id }}" class="filtr-items__check-label">{{ brand.name }}
                                </li>
                            </label>
                          {% endfor %}
{#                            <label for="kia" class="filtr-items__check-label">#}
{#                                <li class="filtr-items__sub-item"><input class="filtr-items__check" type="checkbox" name="mark" id="kia">#}
{#                                    <label for="kia" class="filtr-items__check-label">КИА#}
{#                                </li>#}
{#                            </label>#}
{#                            <label for="bmw" class="filtr-items__check-label">#}
{#                                <li class="filtr-items__sub-item" ><input class="filtr-items__check" type="checkbox" name="mark" id="bmw">#}
{#                                    <label for="bmw" class="filtr-items__check-label">BMW#}
{#                                </li>#}
{#                            </label>#}
                        </ul>
                    </li>
                    <li class="filtr-items__item">
                        <p class="filtr-items__title">Водитель</p>
                        <ul class="filtr-items__sub-menu">
                          {% for driver in view.get_drivers %}
                            <label for="{{ driver.user }}" class="filtr-items__check-label">
                                <li class="filtr-items__sub-item"><input class="filtr-items__check" type="checkbox" name="driver" value="{{ driver.user.id}}" id="{{ driver.user }}">
                                    <label for="{{ driver.user }}" class="filtr-items__check-label">
                                        {{ driver.user.last_name}} {{ driver.user.first_name|first}}.{{ driver.user.patronymic|first}}.
                                </li>
                            </label>
                          {% endfor %}
{#                            <label for="ivanov_i_i" class="filtr-items__check-label">#}
{#                                <li class="filtr-items__sub-item"><input class="filtr-items__check" type="checkbox" name="driver" id="ivanov_i_i">#}
{#                                    <label for="ivanov_i_i" class="filtr-items__check-label">Иванов И.И.#}
{#                                </li>#}
{#                            </label>#}
{#                            <label for="degtyrev_k_k" class="filtr-items__check-label">#}
{#                                <li class="filtr-items__sub-item" ><input class="filtr-items__check" type="checkbox" name="driver" id="degtyrev_k_k">#}
{#                                    <label for="degtyrev_k_k" class="filtr-items__check-label">Дегтярев К.К.#}
{#                                </li>#}
{#                            </label>#}
                        </ul>
                    </li>
                    <li class="filtr-items__item">
                        <p class="filtr-items__title">Регион</p>
                        <ul class="filtr-items__sub-menu">
                          {% for car in view.get_regions %}
                            <label for="{{ car.region_code }}" class="filtr-items__check-label">
                                <li class="filtr-items__sub-item"><input class="filtr-items__check" type="checkbox" name="region" value="{{ car.region_code }}" id="{{ car.region_code }}">
                                    <label for="{{ car.region_code }}" class="filtr-items__check-label">{{ car.region_code }}
                                </li>
                            </label>
                          {% endfor %}
{#                            <label for="87" class="filtr-items__check-label">#}
{#                                <li class="filtr-items__sub-item"><input class="filtr-items__check" type="checkbox" name="region" id="87">#}
{#                                    <label for="87" class="filtr-items__check-label">87#}
{#                                </li>#}
{#                            </label>#}
{#                            <label for="89" class="filtr-items__check-label">#}
{#                                <li class="filtr-items__sub-item" ><input class="filtr-items__check" type="checkbox" name="region" id="89">#}
{#                                    <label for="89" class="filtr-items__check-label">89#}
{#                                </li>#}
{#                            </label>#}
                        </ul>
                    </li>

                    <li class="filtr-items__item">
                        <p class="filtr-items__title">Тип заявки</p>
                        <ul class="filtr-items__sub-menu">
                            {% for app in view.get_types_of_app %}
                            <label for="{{ app.title }}" class="filtr-items__check-label">
                                <li class="filtr-items__sub-item" ><input class="filtr-items__check" type="checkbox" name="type_of_app" value="{{ app.id }}" id="{{ app.title }}">
                                    <label for="{{ app.title }}" class="filtr-items__check-label">{{ app.title }}
                                </li>
                            </label>
                            {% endfor %}
                        </ul>
                    </li>

                    <button type="submit" class="filtr-items__button">
                        <img src="{% static 'icons/lupa.svg' %}" alt="поиск">
                    </button>
                </ul>
            <button class="btn-reset" type="reset">Сбросить</button>
            </form>

                <div class="main__information">
                    <table class="main__table table">
                        <tr class="table__titles">
                          <th class="table__title">Номер</th>
                          <th class="table__title">Водитель</th>
                          <th class="table__title">Марка</th>
                          <th class="table__title">регион</th>
                          <th class="table__title">Последний <br>осмотр</th>
                          <th class="table__title">Активные <br>заявки</th>
                        </tr>
                        {% for car in cars %}
{#                        A-111-EE#}
                        <tr class="table__row">
                          <td class="table__cell">{{ car.registration_number|slice:'0:1'}}-{{ car.registration_number|slice:'1:4'}}-{{ car.registration_number|slice:'4:6'}}</td>
                          <td class="table__cell">{{ car.owner.user.last_name}} {{ car.owner.user.first_name|first}}.{{ car.owner.user.patronymic|first}}.</td>
                          <td class="table__cell">{{ car.brand }}</td>
                          <td class="table__cell">{{ car.region_code }}</td>
                          <td class="table__cell">12.04.22</td>
                          <td class="table__cell">
                              {% for application in car.applications.all %}
                                <table>
                                    <tr>
                                        <td>{{ application.type_of }}</td>
                                        <td>{{ application.start_date }}</td>
                                    </tr>
                                </table>
                            {% endfor %}
                          </td>
                        </tr>

                         {% endfor %}
{#                        <tr class="table__row">#}
{#                          <td class="table__cell">B-112-KT</td>#}
{#                          <td class="table__cell">Иванов И.И.</td>#}
{#                          <td class="table__cell">Tayota</td>#}
{#                          <td class="table__cell">86</td>#}
{#                          <td class="table__cell">11.03.22</td>#}
{#                          <td class="table__cell"> Пробило Колесо<br>#}
{#                            Разбито зеркало<br></td>#}
{#                        </tr>#}
{#                        <tr class="table__row">#}
{#                          <td class="table__cell">E-199-CN</td>#}
{#                          <td class="table__cell">Дегтярев К.К.</td>#}
{#                          <td class="table__cell">BMW</td>#}
{#                          <td class="table__cell">77</td>#}
{#                          <td class="table__cell">12.12.21</td>#}
{#                          <td class="table__cell"> Пробило Колесо<br>#}
{#                            Разбито зеркало<br></td>#}
{#                          </tr>#}
{#                        <tr class="table__row">#}
{#                          <td class="table__cell">K-123-OP</td>#}
{#                          <td class="table__cell">Утров Б.Б.</td>#}
{#                          <td class="table__cell">АвтоВАЗ</td>#}
{#                          <td class="table__cell">86</td>#}
{#                          <td class="table__cell">22.02.22</td>#}
{#                          <td class="table__cell"> Пробило Колесо<br>#}
{#                            Разбито зеркало<br></td>#}
{#                        </tr>#}
{#                        <tr class="table__row">#}
{#                          <td class="table__cell">D-297-NN</td>#}
{#                          <td class="table__cell">Ульянов Д.Д.</td>#}
{#                          <td class="table__cell">Tayota</td>#}
{#                          <td class="table__cell">79</td>#}
{#                          <td class="table__cell">29.11.21</td>#}
{#                          <td class="table__cell"> Пробило Колесо<br>#}
{#                            Разбито зеркало<br></td>#}
{#                        </tr>#}
                    </table>
                </div>
            </div>
        </div>
{% endblock main %}