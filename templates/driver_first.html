{% extends 'base.html' %}
{% load static %}

{% block static_href %}
    {% static 'css/drivers.css' %}
{% endblock static_href %}

{% block title %} Водители {% endblock title%}

{% block driver_active %} active-page   {% endblock driver_active %}

{% block main %}
<div class="main">
            <div class="main__container">

                <div class="main__title">
                    <h1>Сотрудники</h1>
                    <p>{{ drivers.count }}</p>
                </div>
            <form method="get" action="{% url 'drivers' %}">
                {#          ФИО         #}
                {#    номер телефона    #}
                {#                   #}
                <ul class="main__filtration filtr-items">
                    <li class="filtr-items__item placeholder">
                        <input name="registration_number" type="text" placeholder="ФИО" value="">
                    </li>
                <li class="filtr-items__item placeholder">
                        <input name="registration_number" type="text" placeholder="ФИО" value="">
                    </li>
                    <li class="filtr-items__item">
                        <p class="filtr-items__title">Марка</p>
                        <ul class="filtr-items__sub-menu">
                          {% for brand in view.get_car_brands %}
                            <label for="{{ brand.id }}" class="filtr-items__check-label">
                                <li class="filtr-items__sub-item"><input class="filtr-items__check" type="checkbox" name="brand" value="{{ brand.id }}" id="{{ brand.id }}">
                                    <label for="{{ brand.id }}" class="filtr-items__check-label">{{ brand.name }}
                                </li>
                            </label>
                          {% endfor %}

                        </ul>
                    </li>
                    <li class="filtr-items__item">
                        <p class="filtr-items__title">Водитель</p>
                        <ul class="filtr-items__sub-menu">
                          {% for driver in view.get_drivers %}
                            <label for="{{ driver.user }}" class="filtr-items__check-label">
                                <li class="filtr-items__sub-item"><input class="filtr-items__check" type="checkbox" name="driver" value="{{ driver.user.id}}" id="{{ driver.user }}">
                                    <label for="{{ driver.user }}" class="filtr-items__check-label">
                                        {{ driver.user.last_name}} {{ driver.user.first_name|first}}.{{ driver.user.patronymic|first}}.
                                </li>
                            </label>
                          {% endfor %}

                        </ul>
                    </li>
                    <li class="filtr-items__item">
                        <p class="filtr-items__title">Регион</p>
                        <ul class="filtr-items__sub-menu">
                          {% for car in view.get_regions %}
                            <label for="{{ car.region_code }}" class="filtr-items__check-label">
                                <li class="filtr-items__sub-item"><input class="filtr-items__check" type="checkbox" name="region" value="{{ car.region_code }}" id="{{ car.region_code }}">
                                    <label for="{{ car.region_code }}" class="filtr-items__check-label">{{ car.region_code }}
                                </li>
                            </label>
                          {% endfor %}

                        </ul>
                    </li>

                    <li class="filtr-items__item">
                        <p class="filtr-items__title">Тип заявки</p>
                        <ul class="filtr-items__sub-menu">
                            {% for app in view.get_types_of_app %}
                            <label for="{{ app.title }}" class="filtr-items__check-label">
                                <li class="filtr-items__sub-item" ><input class="filtr-items__check" type="checkbox" name="type_of_app" value="{{ app.id }}" id="{{ app.title }}">
                                    <label for="{{ app.title }}" class="filtr-items__check-label">{{ app.title }}
                                </li>
                            </label>
                            {% endfor %}
                        </ul>
                    </li>

                    <button type="submit" class="filtr-items__button">
                        <img src="{% static 'icons/lupa.svg' %}" alt="поиск">
                    </button>
                </ul>
            <button class="btn-reset" type="reset">Сбросить</button>
            </form>

              <!--
              ID
              ФИО
              Дата Рождения
              Номер телефона
              Записаные машины
              Активные заявки
              Прикрепленные документы
              -->
                <div class="main__information">
                    <table class="main__table table">
                        <tr class="table__titles">
                          <th class="table__title">ID</th>
                          <th class="table__title fa-maxcdn">ФИО</th>
                          <th class="table__title">Номер <br>телефона</th>
                          <th class="table__title">Записаные <br> машины</th>
                          <th class="table__title">Активные <br>заявки</th>
                          <th class="table__title">Прикрепленные <br>документы</th>
                        </tr>
                        {% for driver in drivers %}

                        <tr class="table__row">
                          <td class="table__cell">{{ driver.pk }}</td>
                          <td class="table__cell">{{ driver.user.last_name}} {{ driver.user.first_name|first}}.{{ driver.user.patronymic|first}}.</td>
                          <td class="table__cell">{{ driver.phone}}</td>
                          <td class="table__cell">{% for car in driver.my_cars.all %}
                                    {{ car.registration_number }}<br>
                          {% endfor %}
                          </td>
                          <td class="table__cell">
                              {% for my_app in driver.my_apps.all %}
                                    {% if my_app.is_active == True %}
                                        {{ my_app.type_of }}
                                    {% endif %}  <br>
                              {% endfor %}

                          </td>
                              <td class="table__cell">
                                 паспорт <br>
                                  снилс
                              </td>
                        </tr>

                         {% endfor %}
                    </table>
                </div>
            </div>
        </div>
{% endblock main %}